---
title: "testing"
output: html_document
---

```{r}
library(tidyverse)
library(plotly)
library(igraph)
```


```{r}
rawEmpirical = read.csv("2seedTransivityData1.csv") %>% 
  dplyr::select(-1) 

rawEmpiricalOld = read.csv("2seedTransivityData.csv") %>% 
  dplyr::select(-1) 

rawEmpirical = rawEmpirical %>% 
  bind_cols(rawEmpiricalOld[, !colnames(rawEmpiricalOld) %in% colnames(rawEmpirical),
                       drop = FALSE]) 

rawRandom = read.csv("2seedTransivityDataRandom1.csv") %>% 
  dplyr::select(-c(1:2)) %>% 
  set_names(paste0("random_", colnames(.))) 


rawRandomOld = read.csv("2seedTransivityDataRandom.csv") %>% 
  dplyr::select(-c(1:2)) %>% 
  set_names(paste0("random_", colnames(.))) 


rawRandom = rawRandom %>% 
  bind_cols(rawRandomOld[, !colnames(rawRandomOld) %in% colnames(rawRandom),
                       drop = FALSE]) 

raw = bind_cols(rawEmpirical, rawRandom) 
 
head(raw)


```

```{r}
dat = raw %>% 
  set_names(paste0("networks_", colnames(.))) %>% 
  rename(seeding.method = "networks_seeding.method") %>% 
  pivot_longer(starts_with("networks_"), 
               names_to = 'network', 
               values_to = '2tran') %>% 
  mutate(network = str_replace(network, "networks_", "")) %>% 
  mutate(num_nodes = as.numeric(word(network, 2, -1, "num_nodes."))) %>% 
  mutate(network = word(network, 1, 1, "num_nodes.")) %>% 
  mutate(type = ifelse(str_detect(network,"random_"), "Random", "Empirical")) %>% 
  filter(!network %in% c("inf.euroroad_", "primary.school.proximity_", "contacts.prox.high.school.2013.attr_", "contacts.prox.high.school.2013_", "webkb.wisc_")) %>% 
  filter(!network %in% paste0("random_", c("inf.euroroad_", "primary.school.proximity_", "contacts.prox.high.school.2013.attr_", "contacts.prox.high.school.2013_", "webkb.wisc_")))


```


```{r}
g = dat %>% 
  group_by(network, seeding.method, num_nodes, type) %>% 
  summarise(`2tran` = mean(`2tran`)) %>% 
  ungroup() %>% 
  ggplot(aes(num_nodes, `2tran`, color = seeding.method, group = seeding.method, 
             label = network)) + 
  geom_point() + 
  geom_line() +
  ggtitle("2-seed transitivity over Number of Nodes") +
  theme_classic() +
  ggthemes::scale_colour_tableau() +
  xlab("Number of Nodes") +
  ylab("Two Seed Transitivity") +
  facet_wrap(~type)

ggplotly(g)
```


```{r}
g = dat %>% 
  group_by(network, seeding.method, num_nodes, type) %>% 
  summarise(`2tran` = mean(`2tran`)) %>% 
  ungroup() %>% 
  filter(type == "Empirical") %>% 
  ggplot(aes(num_nodes, `2tran`, color = seeding.method, group = seeding.method, 
             label = network)) + 
  geom_point() + 
  geom_line() +
  ggtitle("2-seed transitivity over Number of Nodes") +
  theme_classic() +
  ggthemes::scale_colour_tableau() +
  xlab("Number of Nodes") +
  ylab("Two Seed Transitivity") 

ggplotly(g)
```

