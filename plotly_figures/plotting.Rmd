---
title: "testing"
output: html_document
---

```{r}
library(tidyverse)
library(plotly)
library(igraph)
library(tools)
library(janitor)
library(htmlwidgets)
library(ggthemes)
```


```{r}
figure5 = read_csv("figure_5.csv") %>% 
  mutate(version = ifelse(version == "BA","BarabÃ¡si Albert", "Empirical")) %>% 
  mutate(network = str_replace_all(network, "_"," ") %>% str_to_title())
```



```{r}
g = figure5 %>% 
  ggplot(aes(x = N, y = critical_q, colour = seeding_method, label = network)) +
  geom_point() +
  geom_line() +
  theme_classic() +
  scale_colour_tableau() +
  facet_wrap(~version) +
  labs(colour = "Seed Method", y = "Critical q") +
  ggtitle("Cascade Threshold Comparison Across Seeding Methods")


ggplotly(g) %>% 
  layout(width = 800) %>% 
  saveWidget(file = "nVScascade.html")


g %>% 
  saveRDS(file = "nVScascade.RDS")
```




```{r}
figure11 = read_csv("figure_11.csv")
```


```{r}
g = figure11 %>% 
  ggplot(aes(x = q, y = proportion_adopted, colour = seeding_method)) +
  geom_point() +
  geom_line() +
  scale_colour_tableau() +
  theme_classic() +
  labs(colour = "Seed Method", y = "Proportion of Nodes Adopting Innovation") +
  ggtitle("20 Step Threshold Propagation Across q")

ggplotly(g)


g %>% 
  saveRDS(file = "qVSprop.RDS")
```




```{r}
library(igraph)

dd <- read.table("..\\mass_data/less_than_1500_nodes/aves-weaver-social/edges.edgelist")
graph <- graph.data.frame(dd, directed=FALSE)
plot(graph)
```
```{r}

library(visNetwork)
library(geomnet)

nodes <- as.data.frame(unique(dd[, 1]))
colnames(nodes) <- c("id")

edges <- as.data.frame(dd)
colnames(edges) <- c("from", "to")
```


```{r}
#Louvain Comunity Detection
cluster <- cluster_louvain(graph)
cluster_df <- data.frame(as.list(membership(cluster)))
cluster_df <- as.data.frame(t(cluster_df))
cluster_df$label <- rownames(cluster_df)
#Create group column
nodes <- left_join(nodes, cluster_df, by = "V1")
```

```{r}
visNetwork(nodes, edges)
```

